---
import { Image } from 'astro:assets';
import TealingerLogo from '../assets/Tealinger_Wortbildmarke.png'
import CookieBanner from '../components/CookieBanner.astro';

interface Props {
    title: string;
}

const { title } = Astro.props;
const currentYear = new Date().getFullYear();
---

<!doctype html>
<html lang="de">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/tealinger/favicon.svg" />
        <title>Tealinger | {title}</title>
    </head>
    <body class="bg-white text-gray-900 leading-relaxed flex flex-col min-h-screen">
        <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:p-4 focus:bg-tealinger-base focus:text-white z-50">
            Zum Hauptinhalt springen
        </a>
        
<header class="fixed top-0 left-0 w-full z-50 bg-white border-b border-gray-200">
    <nav class="container mx-auto px-4 h-20 flex justify-between items-center" aria-label="Hauptnavigation">
        
        <a href="/tealinger" class="block w-40 md:w-48 relative z-50">
            <Image src={TealingerLogo} alt="Tealinger Logo" class="w-full h-auto object-contain" />
        </a>

        <button 
            id="menu-toggle" 
            class="md:hidden p-2 text-tealinger-base hover:bg-gray-100 rounded focus:outline-none focus:ring-2 focus:ring-tealinger-base z-50"
            aria-label="Hauptmenü öffnen"
            aria-expanded="false"
            aria-controls="primary-navigation"
        >
            <svg id="icon-menu" class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
            <svg id="icon-close" class="w-8 h-8 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>

        <div 
            id="primary-navigation"
            class="fixed inset-0 top-0 left-0 w-full h-screen bg-white z-40 flex flex-col items-center justify-start pt-28 opacity-0 pointer-events-none transition-all duration-300 transform -translate-y-5
                   md:static md:w-auto md:h-auto md:bg-transparent md:flex-row md:pt-0 md:opacity-100 md:pointer-events-auto md:translate-y-0 md:block"
        >
            <ul class="flex flex-col md:flex-row gap-8 md:gap-8 text-xl md:text-base font-medium text-center w-full md:w-auto">
                <li class="w-full md:w-auto">
                    <a href="/tealinger" class="hover:text-tealinger-base hover:bg-gray-50 md:hover:bg-transparent hover:underline decoration-2 underline-offset-4 transition-colors py-4 block md:inline md:py-2">Home</a>
                </li>
                <li class="w-full md:w-auto">
                    <a href="/tealinger/shop" class="hover:text-tealinger-base hover:bg-gray-50 md:hover:bg-transparent hover:underline decoration-2 underline-offset-4 transition-colors py-4 block md:inline md:py-2">Shop</a>
                </li>
                <li class="w-full md:w-auto">
                    <a href="/tealinger/warenkorb" class="hover:text-tealinger-base hover:bg-gray-50 md:hover:bg-transparent hover:underline decoration-2 underline-offset-4 transition-colors py-4 block md:inline md:py-2">Warenkorb</a>
                </li>
            </ul>
        </div>
    </nav>
</header>

        <main id="main-content" class="container mx-auto px-4 py-8 flex-grow">
            <slot />
        </main>

        <footer class="bg-tealinger-dark text-white mt-12 border-t border-green-800">
             <div class="max-w-7xl mx-auto px-4 py-12">
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                     <div>
                         <h2 class="text-2xl font-extrabold mb-4 text-white tracking-tight">Tealinger</h2>
                         <p class="text-green-100 text-sm mb-4">
                             Das feinste Tee-Erlebnis für Genießer. <br>
                             Qualität aus nachhaltigem Anbau.
                         </p>
                     </div>
                     <slot name="footer-content" /> 
                 </div>
                 
                 <div class="border-t border-green-800 mt-12 pt-8 text-center md:flex md:justify-between md:items-center">
                    <p class="text-green-200 text-sm">
                        &copy; {currentYear} Tealinger. Alle Rechte vorbehalten.
                    </p>
                    <p class="text-green-300 text-xs mt-2 md:mt-0">
                        Erstellt mit Astro & Tailwind CSS
                    </p>
                </div>
             </div>
        </footer>
        
        <CookieBanner />

        <script>
            const btn = document.getElementById('menu-toggle');
            const nav = document.getElementById('primary-navigation');
            const iconMenu = document.getElementById('icon-menu');
            const iconClose = document.getElementById('icon-close');

            if (btn && nav && iconMenu && iconClose) {
                btn.addEventListener('click', () => {
                    const isExpanded = btn.getAttribute('aria-expanded') === 'true';
                    
                    // Toggle State
                    btn.setAttribute('aria-expanded', (!isExpanded).toString());
                    
                    // Toggle Visibility Classes
                    // Wir nutzen Tailwind Utility Classes für Logic
                    if (!isExpanded) {
                        // Öffnen
                        nav.classList.remove('opacity-0', 'pointer-events-none');
                        nav.classList.add('opacity-100', 'pointer-events-auto');
                        // Icons tauschen
                        iconMenu.classList.add('hidden');
                        iconClose.classList.remove('hidden');
                        document.body.style.overflow = 'hidden'; // Scrollen verhindern
                    } else {
                        // Schließen
                        nav.classList.add('opacity-0', 'pointer-events-none');
                        nav.classList.remove('opacity-100', 'pointer-events-auto');
                        // Icons tauschen
                        iconMenu.classList.remove('hidden');
                        iconClose.classList.add('hidden');
                        document.body.style.overflow = ''; // Scrollen erlauben
                    }
                });

                // Menü schließen wenn Link geklickt wird
                nav.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => {
                         // Reset Zustand
                         btn.setAttribute('aria-expanded', 'false');
                         nav.classList.add('opacity-0', 'pointer-events-none');
                         nav.classList.remove('opacity-100', 'pointer-events-auto');
                         iconMenu.classList.remove('hidden');
                         iconClose.classList.add('hidden');
                         document.body.style.overflow = '';
                    });
                });
            }
        </script>
    </body>
</html>